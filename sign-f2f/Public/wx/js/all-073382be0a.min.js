(function(){var e,t;t=angular.module("sign",["ngRoute","bw.paging","angularFileUpload"]),t.factory("request",["$rootScope","$http","$location",function(e,t,i){return{check:function(e,t){var i,n,a;switch(e=angular.isObject(e)?e:{code:-1},t||(t=function(){}),parseInt(e.code)){case-2:return layer.msg(e.msg||"即将请求获取用户身份"),a=encodeURIComponent(window.location.href),n="/wechat/oauth?state="+a,window.location.href=n;case-1:i=e.msg||"网络连接超时 OR 服务器错误。"}return t(i,e.info,e.data)},query:function(e,n){var a,s;return s=this,e.method=e.data?"POST":"GET",a=angular.copy(i.search()),e.params=$.extend(a,e.params||{}),e.data=$.param(e.data||{}),e.timeout||(e.timeout=1e4),n||(n=function(){}),t(e).success(function(e){return s.check(e,n)}).error(function(){return n("网络异常，请稍后再试。")})}}}]),t.factory("wechat",["$rootScope","request",function(e,t){return{isReady:!1,getConfig:function(i){return i||(i=function(){}),t.query({url:"wx/studentApi/getConfig",params:{url:e.baseUrl}},function(e,t,n){return i(e,n)})},getReady:function(e){var t;return t=this,e||(e=function(){}),t.isReady?e(null):t.getConfig(function(i,n){return i?e(i):(wx.config(n),wx.ready(function(){return t.isReady=!0,e(null)}),wx.error(function(t){return e("服务初始化失败，如果多次如此，请联系管理员")}))})}}}]),t.config(["$httpProvider","$routeProvider",function(e,t){return e.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",t.when("/home",{title:"首页",controller:"home",templateUrl:"home.html"}).when("/in",{title:"签到",controller:"in",templateUrl:"in.html"}).when("/tosign",{title:"签到",controller:"tosign",templateUrl:"tosign.html"}).when("/helper",{title:"在线帮助",templateUrl:"helper.html"}).when("/qrcode1",{title:"人定人签到",controller:"qrcode1",templateUrl:"qrcode1.html"}).when("/signhistory",{title:"参与签到记录",controller:"signhistory",templateUrl:"signhistory.html"}).when("/signlaunchhistory",{title:"发起签到记录",controller:"signlaunchhistory",templateUrl:"signlaunchhistory.html"}).when("/signlist",{title:"签到列表",controller:"signlist",templateUrl:"signlist.html"}).when("/signspacedetail",{title:"详细列表",controller:"signspacedetail",templateUrl:"signspacedetail.html"}).when("/signspace",{title:"签到空间管理",controller:"signspace",templateUrl:"signspace.html"}).when("/teachingspace",{title:"教学空间",controller:"teachingspace",templateUrl:"teachingspace.html"}).when("/teachingcreate",{title:"发起题目",controller:"teachingcreate",templateUrl:"teachingcreate.html"}).when("/distributehistory",{title:"发题记录",controller:"distributehistory",templateUrl:"distributehistory.html"}).when("/answerhistory",{title:"答题记录",controller:"answerhistory",templateUrl:"answerhistory.html"}).when("/answerlist",{title:"答题记录",controller:"answerlist",templateUrl:"answerlist.html"}).when("/distributelist",{title:"题目记录",controller:"distributelist",templateUrl:"distributelist.html"}).when("/teachinganswer",{title:"参与答题",controller:"answer",templateUrl:"answer.html"}).otherwise({redirectTo:"/home"})}]),t.run(["$rootScope","request",function(e,t){return e.baseUrl=window.location.href.split("#")[0],e.$on("$routeChangeSuccess",function(t,i,n){var a;return $(".ui.modals").html(""),e.title=(null!=(a=i.$$route)?a.title:void 0)||""}),e.scrollTop=function(){$("body,html").animate({scrollTop:0},500)}}]),t.controller("home",["$scope","request",function(e,t){return e.loading=!0,t.query({url:"wx/indexApi"},function(t,i,n){return e.loading=!1,e.error=t,e.data=n,e.notice(null!=i?i.isNoticed:void 0)}),e.notice=function(e){return e?void 0:$(".notice.modal").modal({blurring:!0}).modal("show")}}]),t.controller("in",["$scope","$location","request","wechat",function(e,t,i,n){var a;return e.getQueryString=function(e,t){var i,n;return i=new RegExp("(/?|&)"+t+"=([^&]*)(&|$)","i"),n=e.substr(1).match(i),n?unescape(n[2]):null},e.getLocation=function(){return e.loading?void 0:(e.loading=!0,e.visible=!0,e.signinfo=!1,e.error=!1,e.status="正在定位",n.getReady(function(t){return t?(e.status="签到失败",e.loading=!1,void(e.$$phase||e.$digest())):wx.getLocation({type:"gcj02",success:function(t){return e.status="正在生成签到码",e.$$phase||e.$digest(),i.query({url:"wx/studentApi/signLaunch",data:t},function(t,i,n){if(e.loading=!1,t)return e.status="签到失败",alert(t);switch(n.gencoderesult){case"signSpanError":e.error=!0,e.errorinfo="半小时之内不能连续发起签到哦^_^",e.status="签到失败";break;case"signCountError":e.error=!0,e.errorinfo="一天之内最多只能发起4次签到哦^_^",e.status="签到失败";break;case"maxNumError":e.error=!0,e.errorinfo="对不起，该位置发起签到的人数太多，请稍后重试^_^",e.status="签到失败";break;default:e.error=!1,e.visible=!1,e.signinfo=!0,e.code=n.gencoderesult,e.informtext=n.dfilename,e.signid=n.signid,e.dfilename=n.dfilename}return e.$$phase?void 0:e.$digest()})},fail:function(t){return e.status="定位失败",e.loading=!1,alert("位置获取失败，建议检查是否有安全软件禁止微信获取位置信息"),e.$$phase?void 0:e.$digest()}})}))},e.closeWindow=function(){return n.getReady(function(e){return e?alert(e):wx.closeWindow()})},e.submitQRCode=function(t){return i.query({url:"wx/studentApi/scan",data:{code:t}},function(t,i,n){return t?alert(t):(alert(JSON.stringify(n)),e.success=!0,e.prompt="",e.type=0,$rootScope.signname=e.signname,$rootScope.signid=e.signid)})},e.scanQRCode=function(){return n.getReady(function(t){return t?alert(t):wx.scanQRCode({desc:"scanQRCode desc",needResult:1,scanType:["qrCode"],success:function(t){var i,n;return n=t.resultStr,i=e.getQueryString(n,"c"),alert(i),e.submitQRCode(i)},fail:function(e){return alert("摄像头启动失败，建议检查是否有安全软件禁止微信启用摄像头")}})})},a=t.search().c||"",a?(layer.msg("提交扫码结果中..."),e.submitQRCode(a)):e.visible=!0}]),t.controller("tosign",["$rootScope","$scope","$location","request","wechat",function(e,t,i,n,a){var s;return t.getQueryString=function(e,t){var i,n;return i=new RegExp("(/?|&)"+t+"=([^&]*)(&|$)","i"),n=e.substr(1).match(i),n?unescape(n[2]):null},t.getLocation=function(){return t.isSureBt1=!0,t.isSureBt2=!1,t.isShow=!0,t.$$phase?void 0:t.$digest()},t.assureSign=function(){var e;return t.isSure=!0,e={signid:t.signid,signname:t.signname,incode:String(t.incode),longitude:t.longitude,latitude:t.latitude,accuracy:t.accuracy,speed:t.speed},n.query({url:"wx/studentApi/startSign",data:e},function(e,i,n){return t.loading=!1,e?(t.status="签到失败",t.isSure=!1,alert(e)):(t.success=!0,t.prompt="",t.type=1)})},t.codeinput=function(){var e;if(t.isText=!1,t.isSureBt1=!0,t.isSureBt2=!1,t.isShow=!0,t.status="确定签到",t.$$phase||t.$digest(),e=t.incode,0!==String(e+"").length)if(e){if(4===String(e).length)return t.isText=!0,t.loading=!0,t.status="正在定位",t.error=!1,t.$$phase||t.$digest(),a.getReady(function(i){return i?(t.status="签到失败",t.isText=!1,t.isSureBt1=!0,t.isSureBt2=!1,t.isShow=!0,void(t.$$phase||t.$digest())):wx.getLocation({type:"gcj02",success:function(i){return i.signcode=String(e),t.longitude=i.longitude,t.latitude=i.latitude,t.accuracy=i.accuracy,t.speed=i.speed,n.query({url:"wx/studentApi/fetchSignInfo",data:i},function(e,i,n){if(t.loading=!1,e)return t.status="签到失败",t.informtext="请稍后重试",t.isText=!1,t.isShow=!0,t.isSureBt1=!0,t.isSureBt2=!1,alert(e);switch(n.dfilename){case"nosign":return t.informtext="你的附近好像没有该签到码哦^_^",t.isText=!1,t.isSureBt1=!0,t.isSureBt2=!1,t.isShow=!0,t.status="确定签到";default:return t.informtext=n.dfilename,t.signid=n.signid,t.isSureBt1=!1,t.isSureBt2=!0,t.isText=!1,t.signname=n.dfilename}}),t.$$phase?void 0:t.$digest()},fail:function(e){return t.informtext="定位失败",t.isText=!1,t.isSureBt1=!0,t.isSureBt2=!1,t.isShow=!0,t.status="确定签到",alert("位置获取失败，建议检查是否有安全软件禁止微信获取位置信息"),t.$$phase?void 0:t.$digest()}})})}else;},t.closeWindow=function(){return a.getReady(function(e){return e?alert(e):wx.closeWindow()})},t.submitQRCode=function(e){return n.query({url:"wx/studentApi/scan",data:{code:e}},function(e,i,n){return e?alert(e):(t.success=n.success,t.prompt=n.prompt,t.type=n.type)})},t.scanQRCode=function(){return a.getReady(function(e){return e?alert(e):wx.scanQRCode({desc:"scanQRCode desc",needResult:1,scanType:["qrCode"],success:function(e){var i,n;return n=e.resultStr,i=t.getQueryString(n,"c"),t.submitQRCode(i)},fail:function(e){return alert("摄像头启动失败，建议检查是否有安全软件禁止微信启用摄像头")}})})},s=i.search().c||"",s?(layer.msg("提交扫码结果中..."),t.submitQRCode(s)):t.getLocation()}]),t.controller("history",["$scope","request",function(e,t){return e.loading=!0,t.query({url:"wx/studentApi/getHistoryLogs"},function(t,i,n){return e.loading=!1,e.error=t,e.data=n}),e.sum=function(e,t){return+e+ +t}}]),t.controller("qrcode1",["$scope","$location","$rootScope","$interval","request","wechat",function(e,t,i,n,a,s){var l,r,d,o;return r=t.search().signid||"",d=t.search().signname||"",e.getQueryString=function(e,t){var i,n;return i=new RegExp("(/?|&)"+t+"=([^&]*)(&|$)","i"),n=e.substr(1).match(i),n?unescape(n[2]):null},e.getLocation=function(e){return s.getReady(function(t){return t?e(t):wx.getLocation({type:"gcj02",success:function(t){return e(null,t)},fail:function(t){return e("位置获取失败，建议检查是否有安全软件禁止微信获取位置信息")}})})},e.getQRCode=function(t){return e.havesign=!0,e.notsign=!1,e.getLocation(function(i,n){return i?t(i,n):(n.oldQRCode=e.oldQRCode,r&&(n.sid=r,n.signname=d),a.query({url:"wx/studentApi/getQRCode",data:n},function(i,n,a){switch(a.signOk){case"no":return e.stopInterval(),e.havesign=!1,e.notsign=!0,e.showsn=!1;case"yes":return e.showsn=!0,e.signname=a.signname,t(i,null!=a?a.QRCode:void 0);default:return e.stopInterval(),e.error=a.msg}}))})},e.setQRCode=function(t,n){return n||(n=function(){}),e.getQRCode(function(t,a){var s;return e.error=t,e.oldQRCode=a,s=i.baseUrl+"#/qrcode1?c="+a,$(".qrcode.image").html("").qrcode(s),n(t,a)})},e.closeWindow=function(){return s.getReady(function(e){return e?alert(e):wx.closeWindow()})},e.scanQRCode=function(){return s.getReady(function(t){return t?alert(t):wx.scanQRCode({desc:"scanQRCode desc",needResult:1,scanType:["qrCode"],success:function(t){var i,n;return n=t.resultStr,i=e.getQueryString(n,"c"),e.submitQRCode(i)},fail:function(e){return alert("摄像头启动失败，建议检查是否有安全软件禁止微信启用摄像头")}})})},e.submitQRCode=function(t){return a.query({url:"wx/studentApi/scan",data:{code:t}},function(t,i,n){return t?alert(t):(e.success=!0,e.prompt="",e.type=0,e.signname=n.signname,e.signid=n.signid)})},e.refresh=function(){return e.setQRCode()},l=t.search().c||"",l?(e.success=!1,e.infomess=!1,e.helper=!0,layer.msg("提交扫码结果中..."),e.submitQRCode(l)):(e.infomess=!0,e.success=!1,e.helper=!1,e.setQRCode(),o=n(e.setQRCode,1e4)),i.$on("$routeChangeStart",function(){return n.cancel(o)}),e.stopInterval=function(){return n.cancel(o)}}]),t.controller("qrcode2",["$scope","$rootScope","$interval","request",function(e,t,i,n){var a;return e.getQRCode=function(t){return t||(t=function(){}),n.query({url:"wx/adminApi/getQRCode",data:{oldQRCode:e.oldQRCode}},function(e,i,n){return t(e,null!=n?n.QRCode:void 0)})},e.setQRCode=function(i,n){return n||(n=function(){}),e.getQRCode(function(i,a){var s;return e.error=i,e.oldQRCode=a,s=t.baseUrl+"#/in?c="+a,$(".qrcode.image").html("").qrcode(s),n(i,a)})},e.refresh=function(){return e.setQRCode()},$(".ui.form").form({inline:!0,on:"blur",fields:{num:{identifier:"num",rules:[{type:"empty",prompt:"学号不能为空"}]}},onSuccess:function(){return e.loading=!0,n.query({url:"wx/adminApi/registerSign",data:{num:e.num,name:e.name}},function(t,i,n){return e.loading=!1,t?alert(t):(e.num=e.name="",layer.msg((null!=n?n.prompt:void 0)||"签到成功"))})}}),e.setQRCode(),a=i(e.setQRCode,5e3),t.$on("$routeChangeStart",function(){return i.cancel(a)})}]),t.controller("class",["$scope","$rootScope","$timeout","$filter","request",function(e,t,i,n,a){return i(function(){return $(".help.circle.icon").popup(),$(".ui.dropdown").dropdown()}),e["class"]={key:"",per:15,page:1,sortName:"num",orderBy:!1,data:[],result:[],action:function(e,i,a,s){return 0!==this.data.lenght?(this.key=e||this.key,this.page=i||this.page,a===this.sortName?this.orderBy=!this.orderBy:"boolean"==typeof s&&(this.orderBy=s),this.sortName=a||this.sortName,this.offset=(this.page-1)*this.per,this.result=n("filter")(this.data,this.key),this.result=n("orderBy")(this.result,this.sortName,this.orderBy),this.total=this.result.length,this.result=n("cut")(this.result,this.offset,this.offset+this.per),t.scrollTop()):void 0}},e.getList=function(){return e.loading=!0,a.query({url:"wx/adminApi/getClassSignData"},function(t,i,n){return e.loading=!1,e.error=t,e["class"].data=n,e["class"].action()})},e.getList()}]),t.controller("signspacedetail",["$scope","$location","FileUploader","request",function(e,t,i,n){return e.data=[],e.getSpaceList=function(t){var i;if(!e.loading)return e.error=null,e.loading=!0,i=e.lastrecord,n.query({url:"wx/adminApi/getSignSpaceDetail",params:t?i:{}},function(t,i,n){var a;return e.loading=!1,t?e.error=t:(e.spacename=n.spacename,e.spaceid=n.spaceid,e.myemail=n.email,e.title="该空间共"+n.usercount+"人",e.spacecount=n.spacecount,e.signs=n.spacesign,e.data=e.data.concat(n.list),n.list.length&&(e.lastrecord=n.list.slice(-1)[0]),e.data.length?n.list.length||(e.error="没有更多了..."):e.error="暂无人员信息",a=e.data,e.issort?a.sort(e.sortnum):a.sort(e.sortdepartment))})},e.getSpaceList(!1),e.showsign=function(){return $("#showsigns").modal("show")},e.sendEmail=function(){return 0===e.spacecount?void alert("该空间下暂无签到信息哦^_^!"):($("#smail").modal("show"),$('input[name="mail"]').val(e.myemail))},e.clearEmailInfo=function(){return $('input[name="mail"]').val(""),$('textarea[name="leftword"]').val("")},e.startSendEmail=function(){var t,i,a,s,l;return l={},t=$('input[name="mail"]').val(),i=$('textarea[name="leftword"]').val(),a=e.spaceid,s=e.spacename,l.to=t,l.leftword=i,l.spaceid=a,l.spacename=s,$("#smail").modal("hide"),n.query({url:"wx/commonApi/sendMailSpace",params:l},function(e,t,i){return e&&alert(e),i.status?alert("邮件已发送成功，注意查收!"):alert("发送失败，请稍后重试")})},e.sortbynum=function(){var t;return e.issort=!0,t=e.data,t.sort(e.sortnum)},e.sortbydepartment=function(){var t;return e.issort=!1,t=e.data,t.sort(e.sortdepartment)},e.sortnum=function(e,t){return e.num>=t.num?1:e.num<t.num?-1:void 0},e.sortdepartment=function(e,t){return e.title>=t.title?-1:e.title<t.title?1:void 0}}]),t.controller("signspace",["$scope","$location","FileUploader","request",function(e,t,i,n){var a;return e.data=[],e.getSpaceList=function(t){return e.loading?void 0:(e.error=null,e.loading=!0,n.query({url:"wx/adminApi/getSignSpace",params:t?e.data.slice(-1)[0]:{}},function(t,i,n){return e.loading=!1,t?e.error=t:(e.spacecount=n.spacecount,e.title="签到空间共"+n.spacecount+"个",e.data=n.list,e.data.length?n.list.length?void 0:e.error="没有更多了...":e.error="暂无空间记录")}))},e.getSpaceList(!1),a=e.uploader=new i({url:"wx/adminApi/createSignSpace"}),e.checkname=function(t){var i,n,a,s,l,r;for(i=!1,r=e.data,n=s=0,l=r.length;l>s;n=++s)if(a=r[n],a.spacename===t){i=!0;break}return i},e.uploader.onBeforeUploadItem=function(t){var i,n,a,s,l,r;return s=$(".ui.selection.dropdown").dropdown("get value"),r=$('input[name="spacename"]').val(),l=$('input[name="spacefile"]').val(),i=e.checkname(r),"new"===s&&i?(alert("名称与已有空间重复"),void e.uploader.cancelAll()):s?"nospace"===s?void e.uploader.cancelAll():r?(n=/[^\.](\.xls)$/i,a=/[^\.](\.xlsx)$/i,n.test(l)||a.test(l)?(e.uploaddisable=!0,e.showbar=!0,t.formData=[{spacename:r,selectvalue:s}]):(alert("请输入Excel格式的文件"),void e.uploader.cancelAll())):(alert("请输入签到空间名称！"),void e.uploader.cancelAll()):(alert("请选择是否创建新空间或者覆盖已有空间"),void e.uploader.cancelAll())},e.showhelp=function(){return $("#showhelp").modal("show")},e.uploader.onProgressAll=function(e){},e.uploader.onSuccessItem=function(t,i,n,a){return e.clearSpaceInfo(),alert("列表上传成功，请刷新空间列表！"),$(".fullscreen.modal").modal("hide")},e.uploader.onErrorItem=function(e,t,i,n){},e.clearQueue=function(){return e.uploader.clearQueue()},e.createSpace=function(){return e.clearSpaceInfo(),e.cover=!1,$("#creatspace").modal("show"),e.showbar=!1,$(".ui.selection.dropdown").dropdown("clear"),$(".ui.selection.dropdown").dropdown({allowReselection:!0,onChange:function(t,i,n){return i?("new"!==t?(e.cover=!0,$(".ui.selection.dropdown").dropdown("set text",'<i class="blue undo icon"></i>覆盖已有空间'),e.spacename=i,e.sapcenamedisable=!0):(e.cover=!1,e.spacename="",e.sapcenamedisable=!1),e.$$phase?void 0:e.$digest()):void 0}})},e.clearSpaceInfo=function(){return $('input[name="spacename"]').val(""),$('input[name="spacefile"]').val(""),$(".ui.selection.dropdown").dropdown("clear"),e.uploaddisable=!1,e.showbar=!1,e.uploader.clearQueue()}}]),t.controller("teachingspace",["$scope","$rootScope","$location","request",function(e,t,i,n){return e.dhref=e.fhref="javascript:void(0)",e.loading=!0,n.query({url:"wx/adminApi/getTeachingSpace"},function(t,i,n){return e.loading=!1,t?alert(t):(e.hasExpire=n.hasExpire,e.launchid=n.signid,e.signname=n.signname,e.signtime=n.signtime,e.signlist=n.signlist,e.sllength=n.signlist.length,e.loading=!1)}),e.create=function(){return e.hasExpire?void alert("暂无有效的发题空间"):e.fhref="#/teachingcreate?launchid="+e.launchid+"&hasExpire="+e.hasExpire+"&signname="+e.signname+"&signtime="+e.signtime+"&create=new"},e.anwser=function(){return 0===e.sllength?void alert("暂无有效的答题空间"):e.sllength>1?$("#selectspace").modal("show"):e.dhref="#/teachinganswer?signname="+e.signname+"&launchid="+e.signlist[0].id},e.selectone=function(t){return $("#selectspace").modal("hide"),e.dhref="#/teachinganswer?signname="+e.signname+"&launchid="+t,$("#answerb").click()}}]),t.controller("answer",["$scope","$rootScope","$interval","$location","request",function(e,t,i,n,a){return e.loading=!0,e.submita=!0,e.isText=!0,e.showanswer=!0,e.seconds=0,e.answerstatus=!0,a.query({url:"wx/adminApi/getAnswerInfo"},function(t,n,a){var s,l,r,d,o;return e.loading=!1,t?alert(t):(e.loading=!1,"false"===a.anwserstatus&&(e.answerstatus=!1),a.hasAnswer?(e.showanswer=!1,e.usedseconds=a.usedseconds,e.tlaunchid=a.tlaunchid,e.launchid=a.id,e.answer=a.answer,e.hasExpire=a.hasExpire,o=e.usedseconds,s=Math.floor(o/3600)+"",l=Math.floor(o%3600/60)+"",r=o%60+"",1===s.length&&(s="0"+s),1===l.length&&(l="0"+l),1===r.length&&(r="0"+r),d=s+":"+l+":"+r,e.secondstr=d):a.hasExpire?e.informtext="该空间已过期":a.hasQuestion?"true"===a.anwserstatus?a.hasAnswer?(e.showanswer=!1,e.usedseconds=a.usedseconds,e.answer=a.answer):(e.submita=!1,e.isText=!1,e.informtext="答题进行中，请抓紧时间填写答案哦^_^",e.tlaunchid=a.tlaunchid,e.launchid=a.id,e.signname=a.signname,e.time=a.time,e.hasAnswer=a.hasAnswer,e.secondstr="00:00:00",e.timer=i(e.tracktime,1e3)):e.informtext="该题目已经结束了哦^_^!":e.informtext="你没有需要回答的问题哦^_^")}),e.tracktime=function(){var t,i,n,a,s;return s=e.seconds++,t=Math.floor(s/3600)+"",i=Math.floor(s%3600/60)+"",n=s%60+"",1===t.length&&(t="0"+t),1===i.length&&(i="0"+i),1===n.length&&(n="0"+n),a=t+":"+i+":"+n,e.secondstr=a},e.showstatistic=function(){var t;return e.answerstatus&&!e.hasExpire?void alert("答题结束后才可以查看哦^_^"):(t=[],a.query({url:"wx/adminApi/getAnswerStatisitcs",params:{tlaunchid:e.tlaunchid}},function(i,n,a){var s;return e.loading=!1,i?e.error=i:(e.usercount=a.usercount,$.each(a.list,function(e,i){return t.push([e,i])}),0===e.usercount?void alert("暂无参与答题用户"):($(".fullscreen.modal").modal("show"),s=$.jqplot("chart",[t],{grid:{drawBorder:!1,drawGridlines:!1,background:"#ffffff",shadow:!1},axesDefaults:{},seriesDefaults:{renderer:$.jqplot.PieRenderer,rendererOptions:{showDataLabels:!0,padding:4,sliceMargin:1}},legend:{show:!0,rendererOptions:{},xoffset:2,location:"e"}}),$(".fullscreen.modal").modal("show")))}))},e.submitanswer=function(){var t,n,s,l,r,d,o,c,u,g,h,p,m,v,f,w;if(t=e.inanswer,v=/^[A-Za-z0-9]+$/,!v.test(t))return void alert("请按要求填写答案");for(s=t.split(""),l=o=0,c=s.length;c>o;l=++o)for(r=s[l],d=g=0,m=l-1;m>=0?m>=g:g>=m;d=m>=0?++g:--g)s[l]<s[d]&&(w=s[l],s[l]=s[d],s[d]=w);for(t="",h=0,u=s.length;u>h;h++)f=s[h],t+=f;return t=t.toUpperCase(),n=e.seconds,0!==String(t+"").length?(p={},p.tlaunchid=e.tlaunchid,p.launchid=e.launchid,p.answer=t,p.signname=e.signname,p.time=e.time,p.usedseconds=n,i.cancel(e.timer),e.submita=!0,a.query({url:"wx/adminApi/submitAnswer",params:p},function(i,a,s){return e.loading=!1,i?alert(i):"ok"===s.answerresult?(e.showanswer=!1,e.usedseconds=n,e.answer=t,alert("答案提交成功")):void 0})):void 0}}]),t.controller("teachingcreate",["$scope","$location","$interval","request",function(e,t,i,n){return e.editshow=!0,e.save=!1,e.inputshow=!1,e.anwser=!0,e.status="未开始",e.anwserstatus="false",e.data=[],e.hasExpire=!0,"false"===t.search().hasExpire&&(e.hasExpire=!1),e.launchid=t.search().launchid,e.signname=t.search().signname,e.signtime=t.search().signtime,e.create=t.search().create,e.tlaunchid=t.search().tlaunchid,e.seconds=0,e.secondstr="00:00:00",e.anwsers="暂无",e.notes="暂无",e.questionnum="暂无",e.listflag=!1,e.slidedown=!1,e.slideup=!0,e.title="答题还未开始，暂无记录","old"===e.create&&n.query({url:"wx/adminApi/getQuestionInfo",params:{launchid:e.launchid,tlaunchid:e.tlaunchid}},function(t,n,a){var s,l,r,d,o,c,u,g,h;return e.loading=!1,t?alert(t):(e.hasExpire=a.hasExpire,e.anwserstatus=a.anwserstatus,e.anwsers=a.anwser,c=a.starttime,c=c.replace(/-/g,"/"),s=new Date(c),r=s.getTime().toString(),h=Date.parse(new Date),e.seconds=(h-r)/1e3,e.notes=a.notes,e.questionnum=a.questionnum,e.hasExpire?(e.status="已过期",e.seconds=a.seconds):"true"===e.anwserstatus?($(".ui.toggle.checkbox").checkbox("check"),e.status="答题中",e.timer=i(e.tracktime,1e3)):($(".ui.toggle.checkbox").checkbox("uncheck"),e.status="已结束",e.seconds=a.seconds),g=e.seconds,l=Math.floor(g/3600)+"",d=Math.floor(g%3600/60)+"",o=g%60+"",1===l.length&&(l="0"+l),1===d.length&&(d="0"+d),1===o.length&&(o="0"+o),u=l+":"+d+":"+o,e.secondstr=u,e.getList(!1))}),e.getList=function(t){var i;if("new"!==e.create&&!e.loading)return e.error=null,e.loading=!0,n.query({url:"wx/adminApi/getAllAnwserUsers",params:t?i=e.data.slice(-1)[0]:{tlaunchid:e.tlaunchid}},function(t,i,n){return e.loading=!1,t?e.error=t:(e.data=e.data.concat(n.list),e.title="参与答题共"+n.count+"人",e.data.length&&(e.listflag=!0),e.data.length?n.list.length?void 0:e.error="没有更多了...":e.title="暂无参与答题记录")})},e.showstatistic=function(){var t;return t=[],n.query({url:"wx/adminApi/getAnswerStatisitcs",params:{tlaunchid:e.tlaunchid}},function(i,n,a){var s;return e.loading=!1,i?e.error=i:(e.usercount=a.usercount,$.each(a.list,function(e,i){return t.push([e,i])}),0===e.usercount?void alert("暂无参与答题用户"):($(".fullscreen.modal").modal("show"),s=$.jqplot("chart",[t],{grid:{drawBorder:!1,drawGridlines:!1,background:"#ffffff",shadow:!1},axesDefaults:{},seriesDefaults:{renderer:$.jqplot.PieRenderer,rendererOptions:{showDataLabels:!0,padding:4,sliceMargin:1}},legend:{show:!0,rendererOptions:{},xoffset:2,location:"e"}}),$(".fullscreen.modal").modal("show")))})},e.editAnwser=function(){return e.hasExpire?void 0:(e.anwser=!1,e.editshow=!1,e.save=!0,e.inputshow=!0,e.$$phase?void 0:e.$digest())},e.saveAnwser=function(){var t,i,a,s,l,r,d,o,c,u,g,h,p,m,v,f,w;if(!e.haveExpire){if(p={},t=$("#anwsers").val(),i=$("#notes").val(),a=$("#questionnum").val(),v=/^[A-Za-z]+$/,t=t.toUpperCase(),t!==e.anwsers||i!==e.notes||a!==e.questionnum){for(s=t.split(""),l=o=0,c=s.length;c>o;l=++o)for(r=s[l],d=g=0,m=l-1;m>=0?m>=g:g>=m;d=m>=0?++g:--g)s[l]<s[d]&&(w=s[l],s[l]=s[d],s[d]=w);for(t="",h=0,u=s.length;u>h;h++)f=s[h],t+=f;t=t.toUpperCase(),e.anwsers=t,e.notes=i,e.questionnum=a,"new"!==e.create&&(p.launchid=e.launchid,p.anwserstatus=e.anwserstatus,p.anwser=e.anwsers,p.notes=e.notes,p.questionnum=e.questionnum,p.signname=e.signname,p.signtime=e.signtime,p.seconds=e.seconds,p.create=e.create,p.tlaunchid=e.tlaunchid,n.query({url:"wx/adminApi/updateAnwserStatus",params:p},function(t,i,n){if(e.loading=!1,t)return alert(t);switch(n.launchresult){case"ok":return alert("信息修改成功");default:return alert("更改失败，请稍后重试")}}))}return e.editshow=!0,e.save=!1,e.inputshow=!1,e.anwser=!0,e.$$phase?void 0:e.$digest()}},e.hideshow=function(t){return"up"===t?(e.slidedown=!0,e.slideup=!1):(e.slidedown=!1,e.slideup=!0),e.$$phase||e.$digest(),$("#infotable").slideToggle(200)},e.changeAnwserStatus=function(){var t;if(t={},!e.hasExpire)switch(e.anwserstatus){case"true":return t.launchid=e.launchid,t.anwserstatus="false",t.anwser=e.anwsers,t.notes=e.notes,t.questionnum=e.questionnum,t.signname=e.signname,t.signtime=e.signtime,t.seconds=e.seconds,t.create=e.create,t.tlaunchid=e.tlaunchid,n.query({url:"wx/adminApi/updateAnwserStatus",params:t},function(t,n,a){if(e.loading=!1,t)return alert(t);switch(a.launchresult){case"ok":return e.status="已结束",e.anwserstatus="false",e.create="old",e.tlaunchid=a.tlaunchid,i.cancel(e.timer),$(".ui.toggle.checkbox").checkbox("uncheck"),alert("状态更改成功，已结束");default:return alert("状态更改失败，请稍后重试"),$(".ui.toggle.checkbox").checkbox("check")}});case"false":return t.launchid=e.launchid,t.anwserstatus="true",t.anwser=e.anwsers,t.notes=e.notes,t.questionnum=e.questionnum,t.signname=e.signname,t.signtime=e.signtime,t.seconds=e.seconds,t.create=e.create,t.tlaunchid=e.tlaunchid,n.query({url:"wx/adminApi/updateAnwserStatus",params:t},function(t,n,a){if(e.loading=!1,t)return alert(t);switch(a.launchresult){case"ok":return e.status="答题中",e.create="old",e.tlaunchid=a.tlaunchid,e.anwserstatus="true",e.timer=i(e.tracktime,1e3),$(".ui.toggle.checkbox").checkbox("check"),alert("状态更改成功，答题中");default:return alert("状态更改失败，请稍后重试"),$(".ui.toggle.checkbox").checkbox("uncheck")}})}},e.$$phase||e.$digest(),e.tracktime=function(){var t,i,n,a,s;return s=e.seconds++,t=Math.floor(s/3600)+"",i=Math.floor(s%3600/60)+"",n=s%60+"",1===t.length&&(t="0"+t),1===i.length&&(i="0"+i),1===n.length&&(n="0"+n),a=t+":"+i+":"+n,e.secondstr=a}}]),t.controller("signhistory",["$scope","$location","request",function(e,t,i){return e.data=[],e.getList=function(t){return e.loading?void 0:(e.error=null,e.loading=!0,i.query({url:"wx/adminApi/getSignHistory",params:t?e.data.slice(-1)[0]:{}},function(t,i,n){return e.loading=!1,t?e.error=t:(e.title="你参与签到共"+n.count+"次",e.data=e.data.concat(n.list),e.data.length?n.list.length?void 0:e.error="没有更多了...":e.error="暂无参与签到记录")}))},e.getList(!1)}]),t.controller("distributelist",["$scope","$location","request",function(e,t,i){return e.data=[],e.getList=function(t){return e.loading?void 0:(e.error=null,e.loading=!0,i.query({url:"wx/adminApi/getDistributeList",params:t?e.data.slice(-1)[0]:{}},function(t,i,n){return e.loading=!1,t?e.error=t:(e.title="你发起答题共"+n.count+"次",e.data=e.data.concat(n.list),e.data.length?n.list.length?void 0:e.error="没有更多了...":e.error="暂无历史发起答题信息")}))},e.getList(!1)}]),t.controller("answerlist",["$scope","$location","request",function(e,t,i){return e.data=[],e.getList=function(t){return e.loading?void 0:(e.error=null,e.loading=!0,i.query({url:"wx/adminApi/getAnswerList",params:t?e.data.slice(-1)[0]:{}},function(t,i,n){return e.loading=!1,t?e.error=t:(e.title="你答题共"+n.count+"次",e.data=e.data.concat(n.list),e.data.length?n.list.length?void 0:e.error="没有更多了...":e.error="暂无历史发起答题信息")}))},e.getList(!1)}]),t.controller("answerhistory",["$scope","$location","request",function(e,t,i){return e.data=[],e.getList=function(t){return e.loading?void 0:(e.error=null,e.loading=!0,i.query({url:"wx/adminApi/getAnswerHistory",params:t?e.data.slice(-1)[0]:{}},function(t,i,n){return e.loading=!1,t?e.error=t:(e.title="答题空间共"+n.count+"个",e.data=e.data.concat(n.list),e.data.length?n.list.length?void 0:e.error="没有更多了...":e.error="暂无历史答题空间信息")}))},e.getList(!1)}]),t.controller("distributehistory",["$scope","$location","request",function(e,t,i){return e.data=[],e.getList=function(t){return e.loading?void 0:(e.error=null,e.loading=!0,i.query({url:"wx/adminApi/getDistributeHistory",params:t?e.data.slice(-1)[0]:{}},function(t,i,n){return e.loading=!1,t?e.error=t:(e.title="答题空间共"+n.count+"次",e.data=e.data.concat(n.list),e.data.length?n.list.length?void 0:e.error="没有更多了...":e.error="暂无历史答题空间信息")}))},e.getList(!1)}]),t.controller("signlaunchhistory",["$scope","$location","request",function(e,t,i){return e.data=[],e.getList=function(t){return e.loading?void 0:(e.error=null,e.loading=!0,i.query({url:"wx/adminApi/getLaunchHistory",params:t?e.data.slice(-1)[0]:{}},function(t,i,n){return e.loading=!1,t?e.error=t:(e.title="你发起签到共"+n.count+"次",e.data=e.data.concat(n.list),e.data.length?n.list.length?void 0:e.error="没有更多了...":e.error="暂无历史发起签到信息")}))},e.getList(!1)}]),t.controller("signlist",["$rootScope","$scope","$location","request",function(e,t,i,n){var a;return a={},t.lastrecord=[],t.data=[],t.infotable=!0,t.issort=!1,t.slideup=!0,t.getList=function(e){var i;if(!t.loading)return t.error=null,t.loading=!0,i={},e&&(i=t.lastrecord),n.query({url:"wx/adminApi/getSignList",params:e?i:a},function(e,i,n){var a,s,l,r,d,o,c,u,g,h,p,m,v,f,w,b,y,x,$,k,S,q,C,A;if(t.loading=!1,e)return t.error=e;switch(t.isLaunch=n.isLaunch,t.isLaunch||(t.isHelp=!0),t.signcode=n.signcode,t.signname=n.signname,t.signdate=n.ymd,t.signid=n.signid,t.myemail=n.email,n.spacelist.length&&(t.spacelist=n.spacelist,t.signedpeople=[]),n.spacecount&&(t.spacecount=n.spacecount),t.peopleinspace=n.peopleinspace,t.spaceids=n.spaceids,t.spacecount=t.spaceids.length,c=n.spacecount,t.haveExpire=n.haveExpire,t.isSee=n.isSee,t.isSee?t.cs=!0:(t.errorlist="签到列表不可见^_^!",t.ncs=!0),t.signstatus=n.haveEnd,t.signstatus){case!0:t.statusmsg="已结束";break;case!1:t.statusmsg="签到中"}for(t.haveExpire&&(t.statusmsg="已过期"),t.signid=n.signid,t.signnameshow=!0,t.editshow=!1,t.editicon=!0,t.saveicon=!1,n.list.length&&(t.lastrecord=n.list.slice(-1)[0],t.signedpeople=t.data.concat(n.list)),t.title="共成功签到了"+n.count+"次",t.data=t.signedpeople.concat(),l=[],a=t.data,s=t.peopleinspace,d=0,m=$=0,k=a.length;k>$;m=++$){for(f=a[m],p=f.num+"",h=f.username+"",b=C=0,S=s.length;S>C;b=++C)if(w=s[b],g=w.num+"",u=w.username+"",p===g&&h===u){a[m].isInSpace=!0,s[b].haveSign="yes";break}l[m]=a[m],d=m}for(x=A=0,q=s.length;q>A;x=++A)v=s[x],r=v.haveSign,o=s[x].num+"","no"===r&&(d++,l[d]=s[x]);return t.data=l,y=t.data,t.issort&&y.sort(t.sortnum),t.issort||y.sort(t.sorttime),t.data.length?n.list.length||(t.error="点击加载更多..."):t.error="暂无签到记录",t.$$phase?void 0:t.$digest()})},t.replacestr=function(e){var t,i,n,a,s,l;return e+="",i=e.length,l=i-5,t=i-1,n=e.substring(0,l),a=e.substring(t),s=n+"****"+a},t.sortbynum=function(){var e;return t.issort=!0,e=t.data,e.sort(t.sortnum)},t.sortbytime=function(){var e;return t.issort=!1,e=t.data,e.sort(t.sorttime)},t.sortnum=function(e,t){return e.num>=t.num?1:e.num<t.num?-1:void 0},t.sorttime=function(e,t){return e.time>=t.time?-1:e.time<t.time?1:void 0},t.changeSignStatus=function(){var e;if(e={},!t.haveExpire)switch(t.signstatus){case!0:return e.signid=t.signid,e.signstatus=!1,n.query({url:"wx/adminApi/updateSignStatus",params:e},function(e,i,n){if(t.loading=!1,e)return alert(e);switch(n.result){case"ok":return t.statusmsg="签到中",t.signstatus=!1,alert("状态更改成功，签到中");case"error":return alert("状态更改失败，请稍后重试"),$(".ui.toggle.checkbox").checkbox("uncheck")}});case!1:return e.signid=t.signid,e.signstatus=!0,n.query({url:"wx/adminApi/updateSignStatus",params:e},function(e,i,n){if(t.loading=!1,e)return alert(e);switch(n.result){case"ok":return t.statusmsg="已结束",t.signstatus=!0,alert("状态更改成功，已结束");case"error":return alert("状态更改失败，请稍后重试"),$(".ui.toggle.checkbox").checkbox("check")}})}},t.changeSeenable=function(e){var i;if(!t.haveExpire)return i={},i.signid=t.signid,i.isseen=e,n.query({url:"wx/adminApi/updateIsSeen",params:i},function(e,i,n){if(t.loading=!1,e)return alert(e);switch(n.result){case"ok":return alert("用户可见状态修改成功");case"error":return alert("修改失败，请稍后重试")}})},t.editSignSpace=function(){var e,i,n,a,s;if($("#espace").modal("show"),t.spaceids.length)for(s=t.spaceids,e=n=0,a=s.length;a>n;e=++n)i=s[e],$(".ui.multiple.dropdown").dropdown("set selected",i);return $(".ui.multiple.dropdown").dropdown({onChange:function(e,i,n){return t.spacecount=e.split(",").length,t.$$phase?void 0:t.$digest()}})},t.submitSpaceTable=function(){var e,i;return i=$(".ui.multiple.dropdown").dropdown("get value"),"nospace"!==i?(e=t.signid,n.query({url:"wx/adminApi/updataSpaceTable",params:{spacevalue:i,signid:e}},function(e,t,i){return e&&alert(e),alert("空间关联成功,请刷新签到列表！"),$("#espace").modal("hide")})):void 0},t.sendEmail=function(){return $("#smail").modal("show"),$('input[name="mail"]').val(t.myemail)},t.clearEmailInfo=function(){return $('input[name="mail"]').val(""),$('textarea[name="leftword"]').val("")},t.startSendEmail=function(){
var e,i,a,s,l;return l={},e=$('input[name="mail"]').val(),i=$('textarea[name="leftword"]').val(),s=t.signid,a=t.signcode,l.to=e,l.title=t.signname,l.leftword=i,l.signid=s,l.signcode=a,$("#smail").modal("hide"),n.query({url:"wx/commonApi/sendMail",params:l},function(e,t,i){return e&&alert(e),i.status?alert("邮件已发送成功，注意查收!"):alert("发送失败，请稍后重试")})},t.hideshow=function(e){return"up"===e?(t.slidedown=!0,t.slideup=!1):(t.slidedown=!1,t.slideup=!0),t.$$phase||t.$digest(),$("#infotable").slideToggle(200)},t.editSignname=function(){return t.haveExpire?void 0:(t.signnameshow=!1,t.editshow=!0,t.editicon=!1,t.saveicon=!0,t.$$phase?void 0:t.$digest())},t.saveSignname=function(){var e,i;if(!t.haveExpire)return i={},e=$("#newSignname").val(),e===t.signname?(t.signnameshow=!0,t.editshow=!1,t.editicon=!0,t.saveicon=!1,void(t.$$phase||t.$digest())):(i.signid=t.signid,i.signname=e,n.query({url:"wx/adminApi/updateSignName",params:i},function(i,n,a){if(t.loading=!1,i)return alert(i);switch(a.result){case"ok":return t.signname=e,alert("名称修改完成");case"error":return alert("修改失败，请稍后重试")}}),t.signnameshow=!0,t.editshow=!1,t.editicon=!0,t.saveicon=!1,t.$$phase?void 0:t.$digest())},t.getList(!1)}]),t.controller("desk",["$scope","$location","request",function(e,t,i){return e.data=[],e.getList=function(t){return e.loading?void 0:(e.error=null,e.loading=!0,i.query({url:"wx/adminApi/getOnePlace",params:t?e.data.slice(-1)[0]:{}},function(t,i,n){return e.loading=!1,t?e.error=t:(e.title=n.name+"今日共成功签到"+n.count+"次",e.data=e.data.concat(n.list),e.data.length?n.list.length?void 0:e.error="没有更多了...":e.error=n.name+"今日暂无签到情况")}))},e.getList(!1)}]),t.filter("cut",e=function(){return function(e,t,i){return e.slice(t||0,i||e.length)}})}).call(this),angular.module("bw.paging",[]).directive("paging",function(){function e(e,t,i){e.$watchCollection("[page,pageSize,total]",function(){o(e,i)})}function t(e,t){e.List=[],e.Hide=!1,e.dots=e.dots||"...",e.page=parseInt(e.page)||1,e.total=parseInt(e.total)||0,e.ulClass=e.ulClass||"pagination",e.adjacent=parseInt(e.adjacent)||1,e.activeClass=e.activeClass||"active",e.disabledClass=e.disabledClass||"disabled",e.scrollTop=e.$eval(t.scrollTop),e.hideIfEmpty=e.$eval(t.hideIfEmpty)||!0,e.showPrevNext=e.$eval(t.showPrevNext)}function i(e,t){e.page>t&&(e.page=t),e.page<=0&&(e.page=1),e.adjacent<=0&&(e.adjacent=2),1>=t&&(e.Hide=e.hideIfEmpty)}function n(e,t){e.page!=t&&(e.page=t,e.pagingAction({page:e.page,pageSize:e.pageSize,total:e.total}),e.scrollTop&&scrollTo(0,0))}function a(e,t,i){if(e.showPrevNext&&!(1>t)){var a,s,l;if("prev"===i){a=e.page-1<=0;var r=e.page-1<=0?1:e.page-1;s={value:"<<",title:"First Page",page:1},l={value:"<",title:"Previous Page",page:r}}else{a=e.page+1>t;var d=e.page+1>=t?t:e.page+1;s={value:">",title:"Next Page",page:d},l={value:">>",title:"Last Page",page:t}}var o=function(t,i){e.List.push({value:t.value,title:t.title,liClass:i?e.disabledClass:"",action:function(){i||n(e,t.page)}})};o(s,a),o(l,a)}}function s(e,t,i){var a=0;for(a=e;t>=a;a++){var s={value:a,title:"Page "+a,liClass:i.page==a?i.activeClass:"",action:function(){n(i,this.value)}};i.List.push(s)}}function l(e){e.List.push({value:e.dots})}function r(e,t){s(1,1,e),3!=t&&l(e)}function d(e,t,i){i!=e-2&&l(t),s(e,e,t)}function o(e,n){(!e.pageSize||e.pageSize<=0)&&(e.pageSize=1);var l=Math.ceil(e.total/e.pageSize);t(e,n),i(e,l);var o,c,u=2*e.adjacent+2;a(e,l,"prev"),u+2>=l?(o=1,s(o,l,e)):e.page-e.adjacent<=2?(o=1,c=1+u,s(o,c,e),d(l,e,c)):e.page<l-(e.adjacent+2)?(o=e.page-e.adjacent,c=e.page+e.adjacent,r(e,o),s(o,c,e),d(l,e,c)):(o=l-u,c=l,r(e,o),s(o,c,e)),a(e,l,"next")}return{restrict:"EA",link:e,scope:{page:"=",pageSize:"=",total:"=",dots:"@",hideIfEmpty:"@",ulClass:"@",activeClass:"@",disabledClass:"@",adjacent:"@",scrollTop:"@",showPrevNext:"@",pagingAction:"&"},template:'<div class="ui mini basic buttons" ng-hide="Hide" ng-class="ulClass"> <div class="ui button"title="{{Item.title}}" ng-class="Item.liClass" ng-click="Item.action()" ng-repeat="Item in List"> <span ng-bind="Item.value"></span> </div></div>'}}),angular.module("sign").run(["$templateCache",function(e){e.put("answer.html",'<div class="main navbar"><a class="center">开始答题</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i>返回</a></div><div class="ui container"><div ng-include="\'loading.html\'" ng-show="loading"></div><div class="ui container" ng-show="!showanswer"><table id=\'infotable\' class="ui three column teal striped unstackable attached table"><tr><td>你的答案</td><td colspan=\'2\'>{{answer}}</td></tr><tr><td>答题用时</td><td>{{secondstr}}</td><td><div style="float:right"  class="mini ui circular linkedin icon button" ng-click="showstatistic();"><i class="large bar chart icon"></i></td></tr></table></div><div class="inputcode" ng-show="!loading && showanswer"><p class="ui ignored info attached message" style="margin:0px auto; padding:8px;"><span ng-bind="informtext||\'请按要求填写答案^_^^\'"></span></p><div class="ui input" style="margin-top:-16px"><span>{{secondstr}}</span><input  style="text-align:center;margin-top:10px;font-size:20px;letter-spacing:3px;padding:8px" ng-disabled="isText"  placeholder="请填写答案" ng-model="inanswer"/></div><button class="ui center huge green basic button" ng-disabled="submita" ng-click="submitanswer();"><span>提交答案</span></button></div><div class="ui info message" ng-show="showanswer"><ol class="ui list"><li>目前所有题型均为选择题</li><li>示例：单选题 C；多选题 ABD</li><li>参与答题后可查看答题统计信息</li></ol></div></div><div  class="ui fullscreen modal"><i class="close icon"></i><div class="header">参与答题人数：{{usercount}}</div><div id="chart" style=""></div></div>'),e.put("answerhistory.html",'<div class="main navbar"><a class="center">参与答题列表</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a></div><div class="ui container"><div ng-include="\'loading.html\'" ng-show="!data.length && loading"></div><div class="ui warning message" ng-show="!data.length  && !loading && error"><div ng-bind="error"></div></div><div ng-show="data.length"><div class="ui positive message" ng-bind="title" style="text-align:center"></div><table class="ui three column green striped center aligned unstackable attached table"><thead><tr><th style="width:29%">题目空间</th><th style="width:35%">时间</th><th style="width:36%">详细</th></tr></thead><tbody><tr ng-repeat="item in data"><td ng-bind="item.signname"></td><td ng-bind="item.signtime"></td><td><a class="mini ui green button"   ng-href="#/answerlist?launchid={{item.launchid}}">>></a></td></tr><tr ng-click="getList(true)"><td colspan="4" ng-if="loading"><i class="asterisk loading icon"></i> 正在努力请求数据...</td><td colspan="4" ng-if="!loading" ng-bind="error || \'点击加载更多...\'"></td></tr></tbody></table></div></div>'),e.put("answerlist.html",'<div class="main navbar"><a class="center">答题列表</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a></div><div class="ui container"><div ng-include="\'loading.html\'" ng-show="!data.length && loading"></div><div class="ui warning message" ng-show="!data.length  && !loading && error"><div ng-bind="error"></div></div><div ng-show="data.length"><div class="ui positive message" ng-bind="title" style="text-align:center"></div><table class="ui three column green striped center aligned unstackable attached table"><thead><tr><th style="width:29%">题号</th><th style="width:35%">备注</th><th style="width:36%">详细</th></tr></thead><tbody><tr ng-repeat="item in data"><td ng-bind="item.questionnum"></td><td ng-bind="item.notes"></td><td><a class="mini ui green button" ng-href="#/teachinganswer?&launchid={{item.launchid}}&tlaunchid={{item.tlaunchid}}">>></a></td></tr><tr ng-click="getList(true)"><td colspan="4" ng-if="loading"><i class="asterisk loading icon"></i> 正在努力请求数据...</td><td colspan="4" ng-if="!loading" ng-bind="error || \'点击加载更多...\'"></td></tr></tbody></table></div></div>'),e.put("class.html",'<div class="main navbar"><a class="center">教学班管理</a><a class="left" href="#/home"><i class="angle left icon"></i> 返回</a></div><div class="ui class container"><div ng-include="\'loading.html\'" ng-show="loading"></div><div class="ui warning message" ng-show="!loading && error"><div class="header" ng-bind="error"></div></div><div class="animate" ng-if="!loading && !error"><form class="ui form"><div class="field"><input type="text" placeholder="输入学号、姓名、班级等进行筛选" ng-model="class.key" ng-change="class.action(class.key, 1)"></div></form><table class="ui three column green striped center aligned unstackable table" ng-show="class.result"><thead><tr><th class="four wide"><span class="pointer" ng-click="class.action(class.key, 1, \'num\', false)">学号 <i class="sort icon"></i></span></th><th class="three wide"><span class="pointer" ng-click="class.action(class.key, 1, \'name\', false)">姓名 <i class="sort icon"></i></span></th><th class="seven wide"><span class="pointer" ng-click="class.action(class.key, 1, \'total_valid\', false)">次数 <i class="sort icon"></i> <i class="help circle icon" data-content="次数为【有效次数/总次数】，为保证每周都有训练，当某周训练次数符合要求时，即使该周还在训练，其有效次数也不会增加"></i></span></th></tr></thead><tbody><tr ng-repeat="item in class.result"><td ng-bind="item.num"></td><td ng-bind="item.name"></td><td ng-bind="item.total + \'/\' + item.total_valid"></td></tr></tbody></table><paging class="paging" page="class.page" page-size="class.per" total="class.total" paging-action="class.action(class.key, page)"></paging></div></div>'),e.put("desk.html",'<div class="main navbar"><a class="center">签到点详情</a><a class="left" href="#/home"><i class="angle left icon"></i> 返回</a></div><div class="ui container"><div ng-include="\'loading.html\'" ng-show="!data.length && loading"></div><div class="ui warning message" ng-show="!data.length  && !loading && error"><div ng-bind="error"></div></div><div ng-show="data.length"><div class="ui positive message" ng-bind="title"></div><table class="ui three column green striped center aligned unstackable attached table"><thead><tr><th class="six wide">学号</th><th class="five wide">姓名</th><th class="five wide">时间</th></tr></thead><tbody><tr ng-repeat="item in data"><td ng-bind="item.num"></td><td ng-bind="item.name"></td><td ng-bind="item.time"></td></tr><tr ng-click="getList(true)"><td colspan="3" ng-if="loading"><i class="asterisk loading icon"></i> 正在努力请求数据...</td><td colspan="3" ng-if="!loading" ng-bind="error || \'点击加载更多...\'"></td></tr></tbody></table></div></div>'),e.put("distributehistory.html",'<div class="main navbar"><a class="center">发起答题列表</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a></div><div class="ui container"><div ng-include="\'loading.html\'" ng-show="!data.length && loading"></div><div class="ui warning message" ng-show="!data.length  && !loading && error"><div ng-bind="error"></div></div><div ng-show="data.length"><div class="ui positive message" ng-bind="title" style="text-align:center"></div><table class="ui three column green striped center aligned unstackable attached table"><thead><tr><th style="width:29%">题目空间</th><th style="width:35%">时间</th><th style="width:36%">详细</th></tr></thead><tbody><tr ng-repeat="item in data"><td ng-bind="item.signname"></td><td ng-bind="item.signtime"></td><td><a class="mini ui green button"   ng-href="#/distributelist?launchid={{item.launchid}}">>></a></td></tr><tr ng-click="getList(true)"><td colspan="4" ng-if="loading"><i class="asterisk loading icon"></i> 正在努力请求数据...</td><td colspan="4" ng-if="!loading" ng-bind="error || \'点击加载更多...\'"></td></tr></tbody></table></div></div>'),e.put("distributelist.html",'<div class="main navbar"><a class="center">所有题目列表</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a></div><div class="ui container"><div ng-include="\'loading.html\'" ng-show="!data.length && loading"></div><div class="ui warning message" ng-show="!data.length  && !loading && error"><div ng-bind="error"></div></div><div ng-show="data.length"><div class="ui positive message" ng-bind="title" style="text-align:center"></div><table class="ui three column green striped center aligned unstackable attached table"><thead><tr><th style="width:29%">题号</th><th style="width:35%">备注</th><th style="width:36%">详细</th></tr></thead><tbody><tr ng-repeat="item in data"><td ng-bind="item.questionnum"></td><td ng-bind="item.notes"></td><td><a class="mini ui green button"   ng-href="#/teachingcreate?launchid={{item.launchid}}&tlaunchid={{item.tlaunchid}}&create=old">>></a></td></tr><tr ng-click="getList(true)"><td colspan="4" ng-if="loading"><i class="asterisk loading icon"></i> 正在努力请求数据...</td><td colspan="4" ng-if="!loading" ng-bind="error || \'点击加载更多...\'"></td></tr></tbody></table></div></div>'),e.put("helper.html",'<div class="main navbar"><a class="center">在线帮助</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a></div><div style="padding: 0rem 5%;"><div class="ui styled accordion"><div class="title"><i class="dropdown icon"></i> 发起签到 </div><div class="content"><img class="ui fluid image" src="Public/wx/img/help-launch-sign-ca0fc585b8.jpg" alt="发起签到"></div><div class="title"><i class="dropdown icon"></i> 参与签到 </div><div class="content"><img class="ui fluid image" src="Public/wx/img/help-attend-sign-c12d64d3b9.jpg" alt="参与签到"></div><div class="title"><i class="dropdown icon"></i> 人定人签到 </div><div class="content"><img class="ui fluid image" src="Public/wx/img/help-f2f-sign-246dda92c1.jpg" alt="人定人签到"></div><div class="title"><i class="dropdown icon"></i> 查看发起签到记录 </div><div class="content"><img class="ui fluid image" src="Public/wx/img/help-launch-sign-history-9b88f0b220.jpg" alt="查看发起签到记录"></div><div class="title"><i class="dropdown icon"></i> 查看参与签到记录 </div><div class="content"><img class="ui fluid image" src="Public/wx/img/help-attend-sign-history-eced688f7f.jpg" alt="查看参与签到记录"></div><div class="title"><i class="dropdown icon"></i> 签到空间 </div><div class="content"><img class="ui fluid image" src="Public/wx/img/help-sign-space-5b101acd4c.jpg" alt="签到空间"></div><div class="title"><i class="dropdown icon"></i> 留言反馈 </div><div class="content"><img class="ui fluid image" src="Public/wx/img/help-feedback-92c738d91a.jpg" alt="留言反馈"></div></div></div><script>$(".accordion").accordion({selector:{trigger:".title"}});</script>'),e.put("history.html",'<div class="main navbar"><a class="center">签到历史</a><a class="left" href="#/home"><i class="angle left icon"></i> 返回</a></div><div class="ui container" style="margin: 15px auto"><div ng-include="\'loading.html\'" ng-show="loading"></div><div class="ui warning message" ng-show="!loading && error"><div class="header" ng-bind="error"></div></div><div ng-show="!loading && !error"><div class="ui success message">提示：本学期需在教学周13至18周期间完成共计12次有效签到。</div><div class="ui segment" style="box-shadow: none;"><h4 class="ui green header">签到统计</h4><div class="ui middle aligned divided relaxed list"><div class="item"><div class="right floated content"><div class="value" ng-bind="sum(data.week_am, data.week_pm)"></div></div><div class="content">本周签到统计</div></div><div class="item"><div class="right floated content"><div class="value" ng-bind="data.term_total"></div></div><div class="content">本学期签到统计</div></div></div></div><div class="ui segment" style="box-shadow: none;" ng-if="data.logs"><h4 class="ui green header">最近签到记录</h4><div class="ui middle aligned divided relaxed list"><div class="item" ng-repeat="item in data.logs"><div class="right floated content"><div class="value" ng-bind="item.time | cut:5:16"></div></div><div class="content" ng-bind="item.part"></div></div></div></div></div></div>'),e.put("home.html",'<div class="main navbar"><a class="center">面对面签到</a></div><div ng-include="\'loading.html\'" ng-show="loading"></div><div class="ui warning container message" ng-show="!loading && error"><div class="header" ng-bind="error"></div></div><div class="home" ng-show="!loading && !error"><div class="ui padded grid"><a class="column" ng-href="{{item.url}}" ng-repeat="item in data.common"><i class="green icon" ng-class="[item.icon]"></i><p ng-bind="item.name"></p></a><a class="column" ng-href="{{item.url}}" ng-repeat="item in data.desks"><i class="green icon" ng-class="[item.icon? item.icon:\'location arrow\']"></i><p ng-bind="item.name"></p></a></div></div>'),e.put("in.html",'<div ng-show="!success"><div class="main navbar"><a class="center">发起签到</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a></div><div class="signcode" ng-show="signinfo"><p class="ui ignored info attached message" style="margin:0px auto; padding:8px;"><span ng-bind="informtext || \'这里是签到默认命名\'"></span></p><div class="ui center"><span ng-bind="code || \'这里是签到码\'"></span></div><button class="ui center huge green basic button"  ng-click="viewSign()"><i class="loading map icon" ng-show="loading"></i><input type="hidden" ng-model="signid"><input type="hidden" ng-model="dfilename"><a style="color: #21ba45" ng-bind="\'查看签到列表\'" ng-href="#/signlist?signid={{signid}}&signname={{dfilename}}"></a></button></div><div class="location well" ng-show="visible"><p class="ui ignored info attached message" ng-show="error" style="margin:0px auto; padding:8px;"><span ng-bind="errorinfo"></span></p><img class="ui centered medium circular image" src="Public/wx/img/logo-65b5f03bf4.png"><button class="ui center huge green basic button"  ng-click="getLocation()"><i class="loading map icon" ng-show="loading"></i><span ng-bind="status || \'发起签到\'"></span></button></div><dl class="helper"><dt>怎么签到</dt><dd>先打开WIFI（只需要打开，连不连接都可以），然后点击上方签到按钮</dd><dt>定位失败怎么办</dt><dd>确保WIFI已经打开，且能够搜索到周围的WIFI信号，最好同时打开GPS</dd><dt>有问题、意见、建议</dt><dd>如果在使用过程中有什么问题、意见或建议，并且在<a href="#/helper">使用帮助</a>中也无法找到想要的结果时，可以通过<a href="http://wechat.hnust.cn/board/#?wechatName=hnust">留言反馈</a>联系我们，留言时请务必说明具体情况（如签到问题请说明当前时间、地点、签到方式等等具体问题描述）</dd><a class="ui info fluid button" href="#/helper">查看更多帮助</a></dl></div><div class="ui location success container" ng-show="success"><div class="icon area"><i class="checkmark icon"></i></div><div class="text area"><h2>签到成功</h2><p style="color:#e64340" ng-bind="prompt"></p></div><a class="fluid ui green button" href="#/history">签到历史</a><a class="fluid ui button" href="#/qrcode1" ng-if="type == 0">辅助同学签到</a><button class="fluid ui button" ng-click="closeWindow()" ng-if="type != 0">关闭页面</button></div>'),e.put("loading.html",'<div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div>'),e.put("qrcode1.html",'<div ng-show="!success"><div class="main navbar"><a class="center">签到二维码</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a></div><div class="ui container"><div class="ui info message" ng-show="infomess"><ol class="ui list"><li>如果您能够正常签到，并且当前正在签到点，你可以辅助你的伙伴进行扫码签到</li><li>如果你还没签到，则可以请求已经签到成功的伙伴辅助你进行扫码签到</li></ol></div><div class="fluid large ui ui instagram button" ng-click="scanQRCode()" ng-show="notsign"><i class="icon qrcode"></i>请求伙伴辅助扫码签到</div><div class="ui segment" style="box-shadow:none" ng-show="havesign"><h4 class="ui center aligned header">辅助伙伴扫码签到(<a href="javascript:void(0)" ng-click="refresh()">刷新</a>)</h4><div class="ui floating message" style="text-align:center;color:teal" ng-show="showsn" ng-if="!error"><h4>{{signname}}</h4></div><div class="ui warning message" ng-show="error" ng-bind="error"></div><div class="ui medium rounded qrcode image" ng-show="!error && oldQRCode"></div><div ng-include="\'loading.html\'" ng-show="!error && !oldQRCode"></div></div><dl class="helper" ng-show="helper"><dt>怎么签到</dt><dd>先打开WIFI（只需要打开，连不连接都可以），然后点击上方签到按钮</dd><dt>定位失败怎么办</dt><dd>确保WIFI已经打开，且能够搜索到周围的WIFI信号，最好同时打开GPS</dd><dt>多次定位失败怎么办</dt><dd>如果多次签到失败，可以寻找附近的同学或者负责的老师，配合进行<a href="javascript:void(0)" ng-click="scanQRCode()">扫码签到</a>或者登记签到</dd><dt>有问题、意见、建议</dt><dd>如果在使用过程中有什么问题、意见或建议，并且在<a href="#/helper">使用帮助</a>中也无法找到想要的结果时可以通过<a href="http://wechat.hnust.cn/board/#?wechatName=hnust">留言反馈</a>联系我们，留言时请务必说明具体情>况（如签到问题请说明当前时间、地点、签到方式等等具体问题描述）</dd><a class="ui info fluid button" href="#/helper">查看更多帮助</a></dl></div></div><div class="ui location success container" ng-show="success"><div class="icon area"><i class="checkmark icon"></i></div><div class="text area"><h2>签到成功</h2><p style="color:#e64340" ng-bind="prompt"></p></div><a class="fluid ui green button" href="#/signlist?signid={{signid}}&signname={{dfilename}}">查看签到列表</a><button class="fluid ui button" ng-click="closeWindow()">关闭页面</button></div>'),e.put("qrcode2.html",'<div class="main navbar"><a class="center">签到二维码</a><a class="left" href="#/home"><i class="angle left icon"></i> 返回</a></div><div class="ui container"><div class="ui segment" style="box-shadow:none"><h4 class="ui center aligned header">请扫码签到(<a href="javascript:void(0)" ng-click="refresh()">刷新</a>)</h4><div class="ui warning message" ng-show="error" ng-bind="error"></div><div class="ui medium rounded qrcode image" ng-show="!error && oldQRCode"></div><div ng-include="\'loading.html\'" ng-show="!error && !oldQRCode"></div></div><form class="ui segment form" style="box-shadow:none"><div class="ui info message"><div class="content">如学生未携带手机或定位扫码均失败的情况下可以尝试手动添加</div></div><div class="field"><label>学号</label><input type="text" name="num" placeholder="请输入学号" ng-model="num"/></div><div class="field"><label>姓名</label><input type="text" name="name" placeholder="姓名只起验证作用，可为空" ng-model="name"/></div><button class="ui teal button" ng-class="{loading:loading}" type="submit">添加</button></form></div>'),e.put("signhistory.html",'<div class="main navbar"><a class="center">参与签到列表</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a></div><div class="ui container"><div ng-include="\'loading.html\'" ng-show="!data.length && loading"></div><div class="ui warning message" ng-show="!data.length  && !loading && error"><div ng-bind="error"></div></div><div ng-show="data.length"><div class="ui positive message" ng-bind="title" style="text-align:center"></div><table class="ui four column green striped center aligned unstackable attached table"><thead><tr><th style="width:20%">名称</th><th style="width:4%">签到码</th><th style="width:30%">时间</th><th style="width:46%">详情</th></tr></thead><tbody><tr ng-repeat="item in data"><td ng-bind="item.signname"></td><td ng-bind="item.incode"></td><td ng-bind="item.time"></td><td><a class="mini ui green button" ng-if="item.isseen == 1"  ng-href="#/signlist?signid={{item.signid}}&signname={{item.signname}}">>></a><a class="mini ui disabled button" ng-if="item.isseen == 0" ng-href="" >>></a></td></tr><tr ng-click="getList(true)"><td colspan="4" ng-if="loading"><i class="asterisk loading icon"></i> 正在努力请求数据...</td><td colspan="4" ng-if="!loading" ng-bind="error || \'点击加载更多...\'"></td></tr></tbody></table></div></div>'),e.put("signlaunchhistory.html",'<div class="main navbar"><a class="center">发起签到列表</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a></div><div class="ui container"><div ng-include="\'loading.html\'" ng-show="!data.length && loading"></div><div class="ui warning message" ng-show="!data.length  && !loading && error"><div ng-bind="error"></div></div><div ng-show="data.length"><div class="ui positive message" ng-bind="title" style="text-align:center"></div><table class="ui four column green striped center aligned unstackable attached table"><thead><tr><th style="width:20%">名称</th><th style="width:4%">签到码</th><th style="width:30%">时间</th><th style="width:46%">详细</th></tr></thead><tbody><tr ng-repeat="item in data"><td ng-bind="item.dfilename"></td><td ng-bind="item.gencoderesult"></td><td ng-bind="item.time"></td><td><a class="mini ui green button"   ng-href="#/signlist?signid={{item.signid}}&signname={{item.dfilename}}">>></a></td></tr><tr ng-click="getList(true)"><td colspan="4" ng-if="loading"><i class="asterisk loading icon"></i> 正在努力请求数据...</td><td colspan="4" ng-if="!loading" ng-bind="error || \'点击加载更多...\'"></td></tr></tbody></table></div></div>'),e.put("signlist.html",'<script type="text/javascript">$(document).ready(function(){$(".ui.radio.checkbox").checkbox(),$(".ui.toggle.checkbox").checkbox()});</script><div class="main navbar"><a class="center">签到列表</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a><a class="right" href="#/home">主页<i class="angle right icon"></i></a></div><div class="ui container"><table id=\'infotable\' class="ui three column teal striped unstackable attached table"><thead><tr><th colspan="3" class="sixteen wide"><span class="ui lightgray label" style="float:left"><i class="setting icon"></i>基本配置</span><div class="ui toggle checkbox" style="float:right;margin-top:3px;" ng-click="changeSignStatus()"><input type="checkbox" name="public" ng-checked="!signstatus" ng-disabled="haveExpire" ng-show="isLaunch"/><label style="color:gray" ng-show="isLaunch">{{statusmsg}}</label></div></th></tr></thead><tbody><tr><td class="four wide">签到码</td><td>{{signcode}}</td><td class="right aligned"><a style="margin-left:20px" class="tiny circular ui icon teal button" href="#/qrcode1?signid={{signid}}&signname={{signname}}" ng-disabled="haveExpire" ng-show="!haveExpire"><i class="large qrcode icon"></i></a></td></tr><tr style="background-color:white"><td>日期</td><td colspan="2">{{signdate}}</td></tr><tr><td class="four wide">名称</td><td class="eight wide"><input  ng-show=\'signnameshow\'  value=\'{{signname}}\' type="text" style="border:1px solid white;width:100%;background:white" disabled="disabled"><input id="newSignname" ng-show=\'editshow\'  value=\'{{signname}}\' type="text" placeholder="请输入..." style="border:1px solid lightgray;width:100%" ></td><td class="right aligned" ng-show="isLaunch"><div class="mini circular ui icon button"  ng-show="editicon" ng-click="editSignname()"><i class="large write icon"></i></div><div class="mini ui circular linkedin icon button" ng-show="saveicon" ng-click="saveSignname()"><i class="large save icon"></i></div></td><td ng-show="!isLaunch"></td></tr><tr ng-show="isLaunch" style="background-color:white"><td class="four wide">签到空间</td><td class="eight wide"><span ng-if="spacecount==0">暂无关联</span><span ng-if="spacecount>0">已关联{{spacecount}}个空间</span></td><td class="right aligned" ng-show="isLaunch"><div class="mini circular ui icon button"  ng-click="editSignSpace()"><i class="large add user icon"></i></div></td></tr><tr ng-show="isLaunch"><td class="four wide">用户可见</td><td colspan="2"><div class="ui radio checkbox" ng-click="changeSeenable(\'true\')"><input type="radio" name="cansee" value="true"  ng-checked="cs" ng-disabled="haveExpire"><label>可见</label></div><div class="ui radio checkbox" style="margin-left:1em" ng-click="changeSeenable(\'false\')"><input type="radio" name="cansee" value="false"  ng-checked="ncs" ng-disabled="haveExpire"><label>不可见</label></div></td></tr></tbody></table><div ng-include="\'loading.html\'" ng-show="!data.length && loading"></div><div class="ui warning message" ng-show="!isSee && !isLaunch  && !loading"><div ng-bind="errorlist"></div></div><div ng-show="data.length && (isSee||isLaunch)"><div class="ui positive message" style="margin-top:14px">{{title}}<a style="margin-left:20px;" class="" href="http://wechat.hnust.cn/sign-f2f/wx/commonApi/downloadSignList?signid={{signid}}&signcode={{signcode}}" ng-show="isLaunch"><i class="large green download icon"></i></a><a style="margin-left:30px;" class="" href="" ng-show="isLaunch" ng-click="sendEmail()"><i class="large green mail outline icon"></i></a><i style="float:right" ng-show="slideup" class="large angle up icon" ng-click=\'hideshow("up")\'></i><i style="float:right" ng-show="slidedown"  class="large angle down icon" ng-click=\'hideshow("down")\'></i></div><table class="ui three column green striped center aligned unstackable attached table"><thead><tr><th class="six wide" ng-click="sortbynum()">学号/工号<i class="sort numeric ascending icon"></i></th><th class="five wide">姓名</th><th class="five wide" ng-click="sortbytime()">时间<i class="sort numeric descending icon"></i></th></tr></thead><tbody><tr ng-repeat="item in data" style="background-color:{{item.isSelf?\'rgb(225,236,244)\':(item.isInSpace?\'rgba(77,200,99,0.05)\':\'white\')}}"><td ng-bind="item.num"></td><td ng-bind="item.username"></td><td><span>{{item.time}}</span></td></tr><tr ng-click="getList(true)"><td colspan="3" ng-if="loading"><i class="asterisk loading icon"></i> 正在努力请求数据...</td><td colspan="3" ng-if="!loading" ng-bind="error || \'点击加载更多...\'"></td></tr></tbody></table></div></div><div id="smail" class="ui fullscreen modal"><i class="close icon"></i><div class="header">发送至邮箱</div><div class="content"><div class="ui form"><div class="field"><div class="ui mini fluid icon input"><input type="text" name="mail" placeholder="邮箱地址..." value="{{myemail}}"  style="font-size:13px"><i class="mail icon"></i></div></div><div class="field" style="margin-top:-15px"><label>留言</label><textarea name="leftword" style="height:20px" placeholder="说点什么吧..."></textarea></div></div></div><div class="actions"><div class="ui button" ng-click="clearEmailInfo()">清空</div><div class="ui green button" ng-click="startSendEmail()">发送</div></div></div><div id="espace" class="ui fullscreen modal"><i class="close icon"></i><div class="header">签到空间配置</div><div class="content" style=""><form class="ui form"><div class="field"><div class="ui multiple dropdown"><input type="hidden" name="filters"><i class="filter icon"></i><span class="text">请选择签到空间</span><div class="menu"><div class="divider"></div><div class="header"><i class="tags icon"></i> 您的签到空间列表 </div><div class="scrolling menu"><div class="item" data-value="{{item.spaceid}}" ng-repeat="item in spacelist"><div class="ui blue empty circular label"></div>{{item.spacename}}</div><div class="item" data-value="nospace" ng-if="scount == 0"><div class="ui blue empty circular label"></div>暂无签到空间</div></div></div></div></div></div><div class="actions" style=""><div class="ui green button" ng-click="submitSpaceTable()" ng-disabled="uploaddisable">确定</div></div></form></div>'),e.put("signspace.html",'<style type="text/css">table.gridtable {font-family: verdana,arial,sans-serif;font-size:11px;color:#333333;border-width: 1px;border-color: #666666;border-collapse: collapse;}table.gridtable th {border-width: 1px;padding: 8px;border-style: solid;border-color: #666666;background-color: #dedede;}table.gridtable td {border-width: 1px;padding: 8px;border-style: solid;border-color: #666666;background-color: #ffffff;}</style><div class="main navbar"><a class="center">签到空间管理</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a></div><div class="ui container"><div ng-include="\'loading.html\'" ng-show="!data.length && loading"></div><div class="ui warning message" ng-show="!data.length  && !loading && error"><div ng-bind="error"></div></div><div><div class="ui positive message">{{title}}<button style="padding:6px 8px;margin-top:-4px" class="ui right floated green button" ng-click=\'createSpace();\'><i class="plus icon"></i>新建</button></div><table class="ui four column green striped center aligned unstackable attached table"><thead><tr><th style="width:40%">空间名称</th><th style="width:20%">总人数</th><th style="width:40%">详情</th></tr></thead><tbody><tr ng-repeat="item in data"><td ng-bind="item.spacename"></td><td ng-bind="item.usercount"></td><td><a class="mini ui green button"   ng-href="#/signspacedetail?spaceid={{item.spaceid}}&spacename={{item.spacename}}">>></a></td></tr><tr ng-click="getSpaceList(true)"><td colspan="4" ng-if="loading"><i class="asterisk loading icon"></i> 正在努力请求数据...</td><td colspan="4" ng-if="!loading" ng-bind="error || \'点击加载更多...\'"></td></tr></tbody></table></div></div><div id="creatspace" class="ui fullscreen modal"><i class="close icon"></i><div class="header">新建签到空间</div><div class="content" style=""><form class="ui form"><div ng-include="\'loading.html\'" ng-show="showbar"  style="margin-top:-20px;"></div><div class="field"><div class="ui selection dropdown"><div class="default text">请选择新建或是覆盖已有空间</div><i class="dropdown icon"></i><div class="menu"><div class="item" data-value="new"><i class="green add user icon"></i>新建空间</div><div class="divider"></div><div class="header"><i class="brown list layout icon"></i>已有签到空间列表</div><div class="item" data-value="{{item.spaceid}}" ng-repeat="item in data">{{item.spacename}}</div><div class="item" data-value="nospace" ng-repeat="spacecount ==0">暂无签到空间</div></div></div></div><div class="field"><label>空间名称</label><div class="ui mini fluid icon input"><input ng-model="spacename" type="text" ng-disabled="sapcenamedisable" value="spacename" name="spacename" placeholder="请输入合适的名称..." style="font-size:13px"><i class="write icon"></i></div></div><div class="field" style=""><label>正确格式的Excel文件<i style="margin-left:12px;margin-top:-6px" class="large blue help circle icon" ng-click=\'showhelp()\'></i></label><div class="ui mini fluid icon input" style="margin-bottom:0px"><input type="file" nv-file-select=\'\' uploader=\'uploader\' name="spacefile" ng-click="clearQueue();"  style="font-size:13px"><i class="file excel outline icon"></i></div></div></div><div class="actions" style=""><div class="ui button" ng-click="clearSpaceInfo()">清空</div><div class="ui green button" ng-click="uploader.uploadItem(0)" ng-disabled="uploaddisable">上传</div></div></form></div><div id="showhelp" class="ui fullscreen modal"><i class="close icon" style="margin-top:-6px"></i><div class="header" style="font-size:14px">上传文件格式模板(.xsl或.xslx格式)</div><div class="content" style=""><div class="field" style=""><label>Excel表格示例:</label><table class="gridtable" style="width:100%;text-align:center"><tr><th>学号/工号</th><th>姓名</th><th>单位</th></tr><tr><td>111111111</td><td>张三</td><td>计算机学院</td></tr><tr><td>2222222</td><td>王五</td><td>外国语学院</td></tr><tr><td>14010502002</td><td>小石头</td><td>马克思学院</td></tr><tr><td>...</td><td>...</td><td>...</td></tr></table></div></div></div></div>'),
e.put("signspacedetail.html",'<style type="text/css">table.gridtable {font-family: verdana,arial,sans-serif;font-size:11px;color:#333333;border-width: 1px;border-color: #666666;border-collapse: collapse;}table.gridtable th {border-width: 1px;padding: 8px;border-style: solid;border-color: #666666;background-color: #dedede;}table.gridtable td {border-width: 1px;padding: 8px;border-style: solid;border-color: #666666;background-color: #ffffff;}</style><div class="main navbar"><a class="center">{{spacename}}</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a></div><div class="ui container"><div ng-include="\'loading.html\'" ng-show="!data.length && loading"></div><div class="ui warning message" ng-show="!data.length  && !loading && error"><div ng-bind="error"></div></div><div><div class="ui positive message">{{title}}<a style="margin-left:20px;" class="" href="http://wechat.hnust.cn/sign-f2f/wx/commonApi/downloadSpaceSignList?spaceid={{spaceid}}&spacename={{spacename}}"><i class="large green download icon"></i></a><a style="margin-left:30px;" class="" href="" ng-click="sendEmail()"><i class="large green mail outline icon"></i></a><a style="" ng-click=\'showsign()\'> <i style="float:right;margin-top:2px"  class="large green list icon" ></i></a></div><table class="ui four column green striped center aligned unstackable attached table"><thead><tr><th style="width:40%" ng-click="sortbynum()">学号/工号<i class="sort numeric ascending icon"></i></th><th style="width:20%">姓名</th><th style="width:40%" ng-click="sortbydepartment()">单位<i class="sort alphabet ascending icon"></i></th></tr></thead><tbody><tr ng-repeat="item in data" style="background-color:white"><td ng-bind="item.num"></td><td ng-bind="item.username"></td><td ng-bind="item.title"></td></tr><tr ng-click="getSpaceList(true)"><td colspan="4" ng-if="loading"><i class="asterisk loading icon"></i> 正在努力请求数据...</td><td colspan="4" ng-if="!loading" ng-bind="error || \'点击加载更多...\'"></td></tr></tbody></table></div></div><div id="smail" class="ui fullscreen modal"><i class="close icon"></i><div class="header">发送至邮箱</div><div class="content"><div class="ui form"><div class="field"><div class="ui mini fluid icon input"><input type="text" name="mail" placeholder="邮箱地址..." value="{{myemail}}"  style="font-size:13px"><i class="mail icon"></i></div></div><div class="field" style="margin-top:-15px"><label>留言</label><textarea name="leftword" style="height:20px" placeholder="说点什么吧..."></textarea></div></div></div><div class="actions"><div class="ui button" ng-click="clearEmailInfo()">清空</div><div class="ui green button" ng-click="startSendEmail()">发送</div></div></div><div id="showsigns" class="ui fullscreen modal"><i class="close icon" style="margin-top:-6px"></i><div class="header" style="font-size:14px">关联的所有签到<span ng-if="spacecount!=0">，共{{spacecount}}次：</span></div><div class="content" style=""><div class="field" style=""><table class="gridtable" style="width:100%;text-align:center"><tr><th>签到名称</th><th>时间</th></tr><tr ng-repeat="sign in signs"><td>{{sign.signname}}</td> <td>{{sign.signdate}}</td></tr><tr ng-if="spacecount == 0"><td colspan=\'2\'>暂无关联的签到</td></tr></table></div></div></div></div>'),e.put("teachingcreate.html",'<script type="text/javascript">$(document).ready(function(){$(".ui.radio.checkbox").checkbox(),$(".ui.toggle.checkbox").checkbox()});</script><div class="main navbar"><a class="center">发起答题</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a><a class="right" href="#/home">主页<i class="angle right icon"></i></a></div><div class="ui container"><table id=\'infotable\' class="ui three column teal striped unstackable attached table"><thead><tr><th colspan="3" class="sixteen wide"><span class="ui lightgray label" style="float:left"><i class="setting icon"></i>基本信息</span><div class="ui toggle checkbox" style="float:right;margin-top:3px;" ng-click="changeAnwserStatus()"><input type="checkbox" ng-disabled="hasExpire" name="public"/><label style="color:gray">{{status}}</label></div></th></tr></thead><tbody><tr><td>答题计时</td><td colsapn=2>{{secondstr}}</td></tr><tr style="border:1px solid red"><td class="four wide">题号</td><td class="five wide"><span ng-show="anwser">{{questionnum}}</span><input id="questionnum" ng-show=\'inputshow\'  value=\'{{questionnum}}\' type="text" placeholder="请输入..." style="border:1px solid lightgray;width:100%" ></td><td class="right aligned"><div class="mini circular ui icon button" ng-show="editshow"  ng-click="editAnwser()"><i class="large write icon"></i></div><div class="mini ui circular linkedin icon button" ng-show="save"  ng-click="saveAnwser()"><i class="large save icon"></i></div></td></tr><tr ><td class="four wide">备注</td><td><span ng-show="anwser">{{notes}}</span><input id="notes" ng-show=\'inputshow\'  value=\'{{notes}}\' type="text" placeholder="请输入..." style="border:1px solid lightgray;width:100%" ></td><td></td></tr><tr><td class="four wide">答案</td><td class="five wide"><span ng-show="anwser">{{anwsers}}</span><input id="anwsers" ng-show=\'inputshow\'  value=\'{{anwsers}}\' type="text" placeholder="请输入..." style="border:1px solid lightgray;width:100%" ></td><td class="right aligned"><div class="mini ui circular linkedin icon button"  ng-click="showstatistic();"><i class="large bar chart icon"></i></div></td></tr></tbody></table><div><div class="ui positive message" style="margin-top:14px">{{title}}<i style="float:right" ng-show="slideup" class="large angle up icon" ng-click=\'hideshow("up")\'></i><i style="float:right" ng-show="slidedown"  class="large angle down icon" ng-click=\'hideshow("down")\'></i></div><table class="ui three column green striped center aligned unstackable attached table"><thead><tr><th class="five wide">姓名</th><th class="four wide">答案<i class="sort alphabet ascending icon"></i></th><th class="six wide" ng-click="sortbytime()">答题用时<i class="sort numeric descending icon"></i></th></tr></thead><tbody><tr ng-repeat="item in data"><td ng-bind="item.name"></td><td ng-bind="item.answer"></td><td><span>{{item.usedseconds}}</span></td></tr><tr ng-click="getList(listflag)"><td colspan="3" ng-if="loading"><i class="asterisk loading icon"></i> 正在努力请求数据...</td><td colspan="3" ng-if="!loading" ng-bind="error || \'点击加载更多...\'"></td></tr></tbody></table></div><div  class="ui fullscreen modal"><i class="close icon"></i><div class="header">答案：{{anwsers}}，人数：{{usercount}}</div><div id="chart" style=""></div></div></div>'),e.put("teachingspace.html",'<div class="main navbar"><a class="center">教学空间</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i>返回</a></div><div class="ui container"><div class="ui info message"><ol class="ui list"><li>目前所有题型均为选择题</li><li>发起签到后，即可以在指定空间中创建答题</li><li>参与签到后，即可选择签到空间参与答题</li><li>查看答题记录 或 查看发题记录</li></ol></div><div ng-include="\'loading.html\'" ng-show="loading"></div><div class="fluid large ui buttons" style="margin-top:5px" ng-show="!loading"><a id="answerb" ng-href="{{dhref}}" class="ui positive button" ng-click="anwser();"><i class="icon write"></i>答题</a><div class="or" data-text="or"></div><a ng-href="{{fhref}}" class="ui blue button" ng-click="create();"><i class="icon plus"></i>发题</a></div><div class="fluid large ui buttons" style="margin-top:20px" ng-show="!loading"  ng-click=""><a class="ui button" ng-href="#/answerhistory"><i class="icon history"></i>答题记录</a><div class="or" data-text="or"></div><a class="ui button" ng-href="#/distributehistory"><i class="icon history"></i>发题记录</a></div></div><div id="selectspace" class="ui fullscreen modal"><i class="close icon" style="margin-top:-6px"></i><div class="header" style="font-size:14px">请选择进入的答题空间</div><div class="content" style=""><div class="field" style=""><table class="gridtable" style="width:100%;text-align:center"><tr ng-repeat="item in signlist"><td><div class="fluid ui button" style="margin-top:4px" tabindex="0" ng-click="selectone(item.id)">{{item.signname}}</div></td></tr></table></div></div></div></div>'),e.put("tosign.html",'<div ng-show="!success"><div class="main navbar"><a class="center">我要签到</a><a class="left" href="javascript:history.go(-1)"><i class="angle left icon"></i> 返回</a><a class="right" href="#/signhistory">参与签到记录 <i class="angle right icon"></i></a></div><div class="inputcode"><p class="ui ignored info attached message" style="margin:0px auto; padding:8px;"><span ng-bind="informtext||\'请输入4位有效的签到码^_^^\'"></span><input type="hidden" ng-model="signid"><input type="hidden" ng-model="longitude"><input type="hidden" ng-model="latitude"><input type="hidden" ng-model="accuracy"><input type="hidden" ng-model="speed"><input type="hidden" ng-model="signname"></p><div class="ui input"><input type="number" style="text-align:center;font-size:20px;letter-spacing:3px;padding:8px" ng-disabled="isText"  placeholder="输入签到码" ng-model="incode" ng-keyup="codeinput()"/></div><button class="ui center huge green basic button" ng-disabled="isShow" ng-show="isSureBt1"><i class="loading map icon" ng-show="loading"></i><span ng-bind="status||\'确定签到\'"></span></button><button class="ui center huge green basic button" ng-disabled="isSure" ng-show="isSureBt2"  ng-click="assureSign()"><span ng-bind="\'确定签到\'"></span></button></div><dl class="helper"><dt>怎么签到</dt><dd>先打开WIFI（只需要打开，连不连接都可以），然后点击上方签到按钮</dd><dt>定位失败怎么办</dt><dd>确保WIFI已经打开，且能够搜索到周围的WIFI信号，最好同时打开GPS</dd><dt>多次定位失败怎么办</dt><dd>如果多次签到失败，可以寻找附近的同学或者负责的伙伴，配合进行<a href="javascript:void(0)" ng-click="scanQRCode()">扫码签到</a>或者登记签到</dd><dt>有问题、意见、建议</dt><dd>如果在使用过程中有什么问题、意见或建议，并且在<a href="#/helper">使用帮助</a>中也无法找到想要的结果时，可以通过<a href="http://wechat.hnust.cn/board/#?wechatName=hnust">留言反馈</a>联系我们，留言时请务必说明具体情况（如签到问题请说明当前时间、地点、签到方式等等具体问题描述）</dd><a class="ui info fluid button" href="#/helper">查看更多帮助</a></dl></div><div class="ui location success container" ng-show="success"><div class="icon area"><i class="checkmark icon"></i></div><div class="text area"><h2>签到成功</h2><p style="color:#e64340" ng-bind="prompt"></p></div><a class="fluid ui green button" ng-href="#/signlist?signid={{signid}}&signname={{signname}}">查看签到名单</a><a class="fluid ui button" href="#/qrcode1" ng-if="type == 0">辅助同学签到</a><button class="fluid ui button" ng-click="closeWindow()" ng-if="type != 0">关闭页面</button></div>')}]);